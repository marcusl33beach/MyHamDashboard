<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ham Radio Dashboard - Boone County Edition</title>
    <style>
        /* GLOBAL RESET */
        html, body {
            margin: 0;
            padding: 0;
            height: 100%;
            overflow: hidden; 
            font-family: "Segoe UI", Roboto, Helvetica, Arial, sans-serif;
            background-color: #1a1a1a; 
            color: #f0f0f0;
        }

        #page-container {
            display: flex;
            flex-direction: column;
            height: 100vh; 
            position: relative;
        }

        /* GRID LAYOUT (4x3) */
        #grid-container {
            flex-grow: 1; 
            display: grid;
            grid-template-columns: repeat(4, 1fr);
            grid-template-rows: repeat(3, 1fr);
            width: 100%;
            height: 100%;
            overflow: hidden; 
        }

        .grid-item {
            width: 100%;
            height: 100%;
            border: 1px solid rgba(255, 255, 255, 0.1); 
            box-sizing: border-box; 
            background-color: #000;
            overflow: hidden; 
            position: relative;
        }

        /* CONTENT STYLING */
        .grid-item img, 
        .grid-item video,
        .grid-item iframe { 
            width: 100%;
            height: 100%;
            display: block;
            border: none;
            object-fit: cover; /* Fills the box */
        }

        /* Exceptions for specific types */
        .grid-item iframe { object-fit: fill; }
        .grid-item img.contain-fit { object-fit: contain; }

        /* ----------------------------------------------------- */
        /* SCROLLING TICKER STYLES (TRANSPARENT & FLOATING)      */
        /* ----------------------------------------------------- */
        #ticker-wrap {
            position: fixed;
            bottom: 0;
            left: 0;
            width: 100%;
            height: 45px;
            background-color: rgba(0, 0, 0, 0.75); /* Transparent Black */
            border-top: 1px solid #555;
            overflow: hidden;
            white-space: nowrap;
            z-index: 9998; /* Below the menu, above grid */
            display: flex;
            align-items: center;
            backdrop-filter: blur(5px);
        }

        #ticker-title {
            background-color: #b00; /* Red label for Alerts */
            color: white;
            padding: 0 15px;
            height: 100%;
            display: flex;
            align-items: center;
            font-weight: bold;
            font-size: 0.9em;
            z-index: 2;
            box-shadow: 2px 0 5px rgba(0,0,0,0.5);
        }

        #ticker-move {
            display: inline-block;
            padding-left: 100%;
            animation: scroll-left 30s linear infinite;
            color: #fff;
            font-size: 1.1em;
            font-weight: 500;
        }

        @keyframes scroll-left {
            0%   { transform: translateX(0); }
            100% { transform: translateX(-100%); }
        }

        /* ----------------------------------------------------- */
        /* NEW DROP DOWN MENU STYLES                             */
        /* ----------------------------------------------------- */
        .menu-container {
            position: fixed;
            top: 20px;
            right: 20px;
            z-index: 9999; /* Highest layer */
        }

        /* The Circle Button */
        .menu-btn {
            background-color: rgba(0, 0, 0, 0.4); /* Transparent dark */
            color: white;
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 50%; /* Makes it a circle */
            width: 45px;
            height: 45px;
            font-size: 24px; /* Size of the dots */
            line-height: 45px;
            text-align: center;
            cursor: pointer;
            transition: background 0.3s, transform 0.2s;
            backdrop-filter: blur(3px);
            user-select: none;
        }

        .menu-btn:hover {
            background-color: rgba(0, 0, 0, 0.9); /* Solid on hover */
            transform: scale(1.1);
        }

        /* The Dropdown Content (Hidden by default) */
        .dropdown-content {
            display: none;
            position: absolute;
            right: 0;
            top: 55px;
            background-color: rgba(0, 0, 0, 0.9);
            min-width: 180px;
            box-shadow: 0px 8px 16px 0px rgba(0,0,0,0.5);
            border-radius: 8px;
            overflow: hidden;
            border: 1px solid #444;
        }

        /* Links inside the dropdown */
        .dropdown-content a {
            color: #f0f0f0;
            padding: 12px 16px;
            text-decoration: none;
            display: block;
            font-size: 0.9em;
            border-bottom: 1px solid #333;
            transition: background 0.2s;
        }

        .dropdown-content a:last-child {
            border-bottom: none;
        }

        .dropdown-content a:hover {
            background-color: #b00; /* Red hover effect */
        }

        /* Show the dropdown menu on hover */
        .menu-container:hover .dropdown-content {
            display: block;
        }

    </style>
</head>
<body>

    <div id="page-container">
        <main id="grid-container"></main>
        
        <div class="menu-container">
            <div class="menu-btn">&#8942;</div>
            <div class="dropdown-content">
                <a href="https://www.weather.gov/" target="_blank">NWS Home</a>
                <a href="https://www.arrl.org/" target="_blank">ARRL</a>
                <a href="https://www.qrz.com/" target="_blank">QRZ.com</a>
                <a href="javascript:location.reload()">Refresh Dashboard</a>
            </div>
        </div>

        <div id="ticker-wrap">
            <div id="ticker-title">BOONE COUNTY WX</div>
            <div id="ticker-move" id="ticker-content">Loading Weather Data...</div>
        </div>
    </div>

    <script>
        /* 1. DEFINE CONTENT URLs */
        const contentUrls = [
            'https://radar.weather.gov/ridge/standard/CONUS_loop.gif', 
            'https://radar.weather.gov/ridge/standard/KNQA_loop.gif', 
            'https://services.swpc.noaa.gov/images/animations/d-rap/global/d-rap/latest.png', 
            'https://services.swpc.noaa.gov/images/swx-overview-large.gif', 
            
            'https://cdn.star.nesdis.noaa.gov/GOES16/GLM/SECTOR/can/EXTENT3/GOES16-CAN-EXTENT3-1125x560.gif', 
            'https://cdn.star.nesdis.noaa.gov/GOES16/GLM/SECTOR/cgl/EXTENT3/GOES16-CGL-EXTENT3-600x600.gif', 
            'https://services.swpc.noaa.gov/experimental/images/aurora_dashboard/tonights_static_viewline_forecast.png', 
            'https://www.blitzortung.org/en/Images/image_b_ny.png', 
            
            'https://www.trimarc.org/images/milestone/CCTV_06_275_0089.jpg', 
            'https://cdn.star.nesdis.noaa.gov/GOES16/ABI/SECTOR/can/13/GOES16-CAN-13-1125x560.gif', 
            'https://himawari8.nict.go.jp/movie/720/20240611_pifd.mp4',
            'https://www.hamqsl.com/solar101vhfpic.php' 
        ];

        /* 2. GRID BUILDER LOGIC */
        function getContentType(url) {
            const lowerUrl = url.toLowerCase();
            if (lowerUrl.endsWith('.mp4')) return 'video';
            if (lowerUrl.includes('solarpic') || lowerUrl.includes('solar101vhfpic')) return 'img';
            return 'img'; 
        }

        const gridContainer = document.getElementById('grid-container');

        function buildGrid() {
            contentUrls.forEach(url => {
                const contentType = getContentType(url);
                const gridItem = document.createElement('div');
                gridItem.classList.add('grid-item');

                let el;
                if (contentType === 'video') {
                    el = document.createElement('video');
                    el.src = url;
                    el.autoplay = true; el.loop = true; el.muted = true; el.controls = false;
                } else {
                    el = document.createElement('img');
                    el.src = url;
                    if(url.includes('hamqsl')) el.classList.add('contain-fit'); 
                    el.onerror = function() { this.style.display='none'; }; 
                }
                
                gridItem.appendChild(el);
                gridContainer.appendChild(gridItem);
            });
        }

        /* 3. WEATHER TICKER LOGIC */
        const RSS_URL = "https://alerts.weather.gov/cap/wwaatmget.php?x=KYZ091&y=0&a=0";
        const API_URL = "https://api.rss2json.com/v1/api.json?rss_url=" + encodeURIComponent(RSS_URL);

        function updateTicker() {
            const ticker = document.getElementById('ticker-move');
            
            fetch(API_URL)
            .then(response => response.json())
            .then(data => {
                if (data.status === 'ok' && data.items.length > 0) {
                    let alertText = "";
                    data.items.forEach(item => {
                        alertText += " ⚠️ " + item.title + " ";
                    });
                    ticker.innerText = alertText + " (Source: NWS) ";
                } else {
                    ticker.innerText = "NO ACTIVE WEATHER ALERTS FOR BOONE COUNTY, KY • 73s WSGA832";
                }
            })
            .catch(error => {
                console.error("Ticker Error:", error);
                ticker.innerText = "Weather Data Unavailable (Check Internet Connection)";
            });
        }

        document.addEventListener('DOMContentLoaded', () => {
            buildGrid();
            updateTicker();
            setInterval(updateTicker, 900000);
        });
    </script>
</body>
</html>